/*! For license information please see commands.js.LICENSE.txt */
!function(){function t(){var e,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function a(t,o,c,i){var a=o&&o.prototype instanceof s?o:s,l=Object.create(a.prototype);return n(l,"_invoke",function(t,n,o){var c,i,a,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:y,f:y.bind(e,4),d:function(t,n){return c=t,i=0,a=e,p.n=n,u}};function y(t,n){for(i=t,a=n,r=0;!f&&s&&!o&&r<l.length;r++){var o,c=l[r],y=p.p,d=c[2];t>3?(o=d===n)&&(a=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=e):c[0]<=y&&((o=t<2&&y<c[1])?(i=0,p.v=n,p.n=c[1]):y<d&&(o=t<3||c[0]>n||n>d)&&(c[4]=t,c[5]=n,p.n=d,i=0))}if(o||t>1)return u;throw f=!0,n}return function(o,l,d){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&y(l,d),i=l,a=d;(r=i<2?e:a)||!f;){c||(i?i<3?(i>1&&(p.n=-1),y(i,a)):p.n=a:p.v=a);try{if(s=2,c){if(i||(o="next"),r=c[o]){if(!(r=r.call(c,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,i<2&&(i=0)}else 1===i&&(r=c.return)&&r.call(c),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=e}else if((r=(f=p.n<0)?a:t.call(n,p))!==u)break}catch(t){c=e,i=1,a=t}finally{s=1}}return{value:r,done:f}}}(t,c,i),!0),l}var u={};function s(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][c]?r(r([][c]())):(n(r={},c,function(){return this}),r),y=f.prototype=s.prototype=Object.create(p);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,n(t,i,"GeneratorFunction")),t.prototype=Object.create(y),t}return l.prototype=f,n(y,"constructor",f),n(f,"constructor",l),l.displayName="GeneratorFunction",n(f,i,"GeneratorFunction"),n(y),n(y,i,"Generator"),n(y,c,function(){return this}),n(y,"toString",function(){return"[object Generator]"}),(t=function(){return{w:a,m:d}})()}function n(t,e,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}n=function(t,e,r,o){if(e)c?c(t,e,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[e]=r;else{var i=function(e,r){n(t,e,function(t){return this._invoke(e,r,t)})};i("next",0),i("throw",1),i("return",2)}},n(t,e,r,o)}function e(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return r(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function o(t,n,e,r,o,c,i){try{var a=t[c](i),u=a.value}catch(t){return void e(t)}a.done?n(u):Promise.resolve(u).then(r,o)}function c(t){return function(){var n=this,e=arguments;return new Promise(function(r,c){var i=t.apply(n,e);function a(t){o(i,r,c,a,u,"next",t)}function u(t){o(i,r,c,a,u,"throw",t)}a(void 0)})}}function i(){return i=c(t().m(function n(r){var o;return t().w(function(n){for(;;)switch(n.n){case 0:return console.log("=== Starting requirement insertion ==="),n.p=1,n.n=2,Word.run(function(){var n=c(t().m(function n(r){var o,c,i,a,u,s,l,f,p,y,d;return t().w(function(t){for(;;)switch(t.n){case 0:return console.log("Loading document content..."),o=r.document.body,r.load(o,"text"),t.n=1,r.sync();case 1:return c=/\[REQ_(\d{4})\]/g,i=o.text.match(c),a=1,i?(console.log("Found ".concat(i.length," existing requirements")),u=i.map(function(t){var n=t.match(/\[REQ_(\d{4})\]/);return parseInt(n[1],10)}),s=Math.max.apply(Math,e(u)),a=s+1,console.log("Next requirement number will be: ".concat(a))):console.log("No existing requirements found, starting with REQ_0001"),l="[REQ_".concat(a.toString().padStart(4,"0"),"]"),f="REQ_".concat(a.toString().padStart(4,"0")),console.log("Inserting requirement: ".concat(l)),p=r.document.getSelection(),y=p.insertText(l,Word.InsertLocation.replace),r.load(y),t.n=2,r.sync();case 2:console.log("Requirement text inserted successfully");try{y.insertBookmark(f),console.log("Bookmark '".concat(f,"' added successfully"))}catch(t){console.error("Error adding bookmark:",t)}return t.p=3,y.style="REQ_TITLE",console.log("Style 'REQ_TITLE' applied successfully"),t.n=4,r.sync();case 4:t.n=6;break;case 5:t.p=5,"InvalidArgument"===(d=t.v).code?console.log("Style 'REQ_TITLE' not found, continuing without styling"):console.error("Error applying style:",d.message);case 6:return y.select("End"),console.log("Cursor positioned at end of inserted text"),t.n=7,r.sync();case 7:return t.a(2)}},n,null,[[3,5]])}));return function(t){return n.apply(this,arguments)}}());case 2:console.log("=== Insert Requirement Function Completed Successfully ==="),n.n=4;break;case 3:n.p=3,o=n.v,console.error("Error inserting requirement:",o);try{Office.context.document.settings.set("lastAction","Error inserting requirement")}catch(t){console.error("Could not show error notification:",t)}case 4:r.completed();case 5:return n.a(2)}},n,null,[[1,3]])})),i.apply(this,arguments)}Office.onReady(function(){}),Office.actions.associate("insertNewRequirement",function(t){return i.apply(this,arguments)})}();
//# sourceMappingURL=commands.js.map